{"version":3,"sources":["assets\\script\\man2.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\nimport GameManager from \"./gamemanager\";\r\nimport GlobalData from \"./GlobalData\";\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    @property(GameManager)\r\n    Gamemanger: GameManager = null;\r\n\r\n    @property(cc.Label)\r\n    label: cc.Label = null;\r\n\r\n    @property(cc.SpriteFrame)\r\n    lie: cc.SpriteFrame = null;\r\n\r\n    @property\r\n    text: string = 'hello';\r\n\r\n    \r\n    @property({type:cc.AudioClip})\r\n    goinSound: cc.AudioClip = null;\r\n\r\n    @property(Number)\r\n    moveSpeed: number = 1.5; \r\n\r\n    animation= null; \r\n\r\n    private isBattle: boolean = false;\r\n\r\n    private isMovingUp: boolean = false;\r\n    private isMovingDown: boolean = false;\r\n    private isMovingLeft: boolean = false;\r\n    private isMovingRight: boolean = false;\r\n    private destroynum = 0;\r\n    public enemyNum = 0;\r\n\r\n    start(){\r\n        let nodetodestory = cc.director.getScene()[\"nodeToDestroy\"];\r\n        console.log(\"nodeToDestroy in man:\", nodetodestory);\r\n        cc.director.getScene().walk((node: cc.Node) => {\r\n            if(GlobalData.nodeToDestroy.includes(node.name)){\r\n                node.destroy();\r\n            }\r\n        }, () => {\r\n        });\r\n        this.Gamemanger = cc.find('Canvas/gamemanager').getComponent('gamemanager');\r\n        this.Gamemanger.palse = false;\r\n    }\r\n\r\n    onLoad() {\r\n        // 注册键盘事件\r\n        cc.director.getPhysicsManager().enabled = true;\r\n        var manager = cc.director.getCollisionManager();\r\n        manager.enabled = true;\r\n        this.animation = this.getComponent(cc.Animation);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n        this.node.setPosition(GlobalData.Player2PosX,GlobalData.Player2PosY);\r\n        \r\n    }\r\n\r\n    onDestroy() {\r\n        // 移除键盘事件监听\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    playAnimation(animationName: string) {\r\n        if (this.animation && this.animation.getAnimationState(animationName).isPlaying) {\r\n            return;\r\n        }\r\n\r\n        this.animation.play(animationName);\r\n    }\r\n\r\n    stopAnimation(animationName: string) {\r\n        if (this.animation && this.animation.getAnimationState(animationName).isPlaying) {\r\n            this.animation.stop(animationName);\r\n        }\r\n    }\r\n\r\n    onKeyDown(event: cc.Event.EventKeyboard) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.w:\r\n                this.isMovingUp = true;\r\n                break;\r\n            case cc.macro.KEY.s:\r\n                this.isMovingDown = true;\r\n                break;\r\n            case cc.macro.KEY.a:\r\n                this.isMovingLeft = true;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.isMovingRight = true;\r\n                break;\r\n            case cc.macro.KEY.space:\r\n                    console.log(this.node);\r\n                    this.node.getComponent(cc.Sprite).spriteFrame = this.lie;\r\n                break;\r\n                \r\n        }\r\n    }\r\n    \r\n    onKeyUp(event: cc.Event.EventKeyboard) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.w:\r\n                this.isMovingUp = false;\r\n                this.stopAnimation(\"man2_up\");\r\n                break;\r\n            case cc.macro.KEY.s:\r\n                this.isMovingDown = false;\r\n                this.stopAnimation(\"man2_down\");\r\n                break;\r\n            case cc.macro.KEY.a:\r\n                this.isMovingLeft = false;\r\n                this.stopAnimation(\"man2_left\");\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.isMovingRight = false;\r\n                this.stopAnimation(\"man2_right\");\r\n                break;\r\n        }\r\n    }\r\n\r\n    update(dt: number) {\r\n        if(this.Gamemanger.palse==false)\r\n        {\r\n            if (this.isMovingUp) {\r\n                this.node.y += (this.moveSpeed * dt);\r\n                if(!this.animation.getAnimationState(\"man2_up\").isPlaying)this.animation.play(\"man2_up\");\r\n            }\r\n            if (this.isMovingDown) {\r\n                this.node.y -= this.moveSpeed * dt;\r\n                if(!this.animation.getAnimationState(\"man2_down\").isPlaying)this.animation.play(\"man2_down\");\r\n            }\r\n            if (this.isMovingLeft) {\r\n                this.node.x -= this.moveSpeed * dt;\r\n                if(!this.animation.getAnimationState(\"man2_left\").isPlaying)this.animation.play(\"man2_left\");\r\n            }\r\n            if (this.isMovingRight) {\r\n                this.node.x += this.moveSpeed * dt ;\r\n                if(!this.animation.getAnimationState(\"man2_right\").isPlaying)this.animation.play(\"man2_right\");\r\n            }\r\n        }\r\n        \r\n        if ((this.node.x >= 48 && this.node.x <= 88) && (this.node.y >= 50 && this.node.y <= 86) && this.isBattle == false) {\r\n        }   \r\n        GlobalData.Player2PosX = this.node.getPosition().x;\r\n        GlobalData.Player2PosY = this.node.getPosition().y;  \r\n    }\r\n\r\n    onBeginContact(contact, selfCollider, otherCollider) {\r\n        // console.log(cc.director.getPhysicsManager().gravity);\r\n        if (otherCollider.node.name === \"sensor0.01\") {\r\n        cc.find(\"Canvas/man2\").getComponent(cc.RigidBody).gravityScale = -0.1;\r\n        this.node.getComponent(cc.Sprite).spriteFrame = this.lie;\r\n        }\r\n        if (otherCollider.node.name === \"sensor0\") {\r\n            cc.find(\"Canvas/man2\").getComponent(cc.RigidBody).gravityScale = 0;\r\n            }\r\n        if (otherCollider.node.name === \"sensorlie\") {\r\n            this.node.getComponent(cc.Sprite).spriteFrame = this.lie;\r\n        }\r\n        let worldManifold = contact.getWorldManifold();\r\n        let points = worldManifold.points;\r\n        let normal = worldManifold.normal;\r\n        if(otherCollider.tag == 4 || otherCollider.tag == 5|| otherCollider.tag == 6|| otherCollider.tag == 7){\r\n            this.enemyNum = otherCollider.tag;\r\n            this.isBattle = true;\r\n            cc.audioEngine.pauseMusic();\r\n            cc.audioEngine.playEffect(this.goinSound, false);\r\n        \r\n            var canvasNode = cc.find(\"Canvas\"); \r\n            var blinkAction = cc.blink(2, 5); \r\n            this.Gamemanger.palse = true;\r\n            console.log(\"fuck your life \",this.Gamemanger.palse);\r\n            canvasNode.runAction(cc.sequence(\r\n                blinkAction,\r\n                cc.callFunc(function () {\r\n                    cc.director.loadScene(\"battle\", () =>{\r\n                       const nextScene = cc.director.getScene();\r\n                       nextScene[\"enemyNum\"] = otherCollider.tag;\r\n                    });\r\n                })\r\n            ));\r\n        }\r\n    }\r\n}"]}