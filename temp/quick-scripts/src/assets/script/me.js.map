{"version":3,"sources":["assets\\script\\me.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class CharacterController extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    p1: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    p2: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    p3: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    character: cc.Node = null;\r\n\r\n    @property(Number)\r\n    moveSpeed: number = 1.5; \r\n\r\n    private isMovingUp: boolean = false;\r\n    private isMovingDown: boolean = false;\r\n    private isMovingLeft: boolean = false;\r\n    private isMovingRight: boolean = false;\r\n    private big: boolean = false;\r\n    private small: boolean = false;\r\n\r\n    start() {\r\n        // 設置初始層級和顯示順序\r\n        this.character.setSiblingIndex(this.p2.getSiblingIndex());\r\n        this.node.scale = 0.8;\r\n\r\n    }\r\n    onLoad(){\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n    onDestroy() {\r\n        // 移除键盘事件监听\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n    onKeyDown(event: cc.Event.EventKeyboard) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.w:\r\n                this.isMovingUp = true;\r\n                break;\r\n            case cc.macro.KEY.s:\r\n                this.isMovingDown = true;\r\n                break;\r\n            case cc.macro.KEY.a:\r\n                this.isMovingLeft = true;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.isMovingRight = true;\r\n                break;\r\n            case cc.macro.KEY.up:\r\n                this.big = true;\r\n                break;\r\n            case cc.macro.KEY.down:\r\n                this.small = true;\r\n                break;\r\n                \r\n        }\r\n    }\r\n    onKeyUp(event: cc.Event.EventKeyboard) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.w:\r\n                this.isMovingUp = false;\r\n                break;\r\n            case cc.macro.KEY.s:\r\n                this.isMovingDown = false;\r\n                break;\r\n            case cc.macro.KEY.a:\r\n                this.isMovingLeft = false;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.isMovingRight = false;\r\n                break;\r\n            case cc.macro.KEY.up:\r\n                this.big = false;\r\n                break;\r\n            case cc.macro.KEY.down:\r\n                this.small = false;\r\n                break;\r\n        }\r\n    }\r\n\r\n    update(dt: number) {\r\n\r\n        if (this.isMovingUp && this.node.y + 58*this.node.scale < 256) {\r\n            this.node.y += (this.moveSpeed * dt);\r\n        }\r\n        if (this.isMovingDown && this.node.y - 58*this.node.scale > -256) {\r\n            this.node.y -= this.moveSpeed * dt;\r\n        }\r\n        if (this.isMovingLeft) {\r\n            this.node.x -= this.moveSpeed * dt;\r\n        }\r\n        if (this.isMovingRight) {\r\n            this.node.x += this.moveSpeed * dt ;\r\n        }\r\n        if (this.big) {\r\n            this.node.scale += 1 * dt;\r\n        }\r\n        if (this.small) {\r\n            this.node.scale -= 1 * dt ;\r\n        }\r\n        // 根據角色Y座標變化調整層級和顯示順序\r\n        console.log(this.node.y);\r\n        if (this.node.scale > 0.7 && this.node.scale < 1) {\r\n            this.character.setSiblingIndex(this.p2.getSiblingIndex()+1);\r\n        }else if (this.node.scale > 1 &&this.node.scale < 2) {\r\n            this.character.setSiblingIndex(this.p1.getSiblingIndex()+1);\r\n        } else if (this.node.scale > 2) {\r\n            this.character.setSiblingIndex(this.p3.getSiblingIndex()+1);\r\n        }\r\n        else\r\n        {\r\n            this.character.setSiblingIndex(this.p2.getSiblingIndex()-1);\r\n        }\r\n    }\r\n}"]}