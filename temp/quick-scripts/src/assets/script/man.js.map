{"version":3,"sources":["assets\\script\\man.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\nimport GameManager from \"./gamemanager\";\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    @property(GameManager)\r\n    Gamemanger: GameManager = null;\r\n\r\n    @property(cc.Label)\r\n    label: cc.Label = null;\r\n\r\n    @property\r\n    text: string = 'hello';\r\n\r\n    @property({type:cc.AudioClip})\r\n    bgm: cc.AudioClip = null;\r\n    \r\n    @property({type:cc.AudioClip})\r\n    goinSound: cc.AudioClip = null;\r\n\r\n    @property(cc.Integer)\r\n    moveSpeed: number = 1; // 移动速度，可以根据需要调整\r\n\r\n    animation= null; // 动画组件\r\n\r\n    private isBattle: boolean = false;\r\n\r\n    private isMovingUp: boolean = false;\r\n    private isMovingDown: boolean = false;\r\n    private isMovingLeft: boolean = false;\r\n    private isMovingRight: boolean = false;\r\n\r\n\r\n    start(){\r\n        cc.audioEngine.playMusic(this.bgm, true);\r\n        this.Gamemanger = cc.find('Canvas/gamemanager').getComponent('gamemanager');\r\n        // console.log(this.Gamemanger);\r\n        this.Gamemanger.palse = false;\r\n    }\r\n\r\n    onLoad() {\r\n        // 注册键盘事件\r\n        cc.director.getPhysicsManager().enabled = true;\r\n        var manager = cc.director.getCollisionManager();\r\n        manager.enabled = true;\r\n        this.animation = this.getComponent(cc.Animation);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n        \r\n    }\r\n\r\n    onDestroy() {\r\n        // 移除键盘事件监听\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    playAnimation(animationName: string) {\r\n        if (this.animation && this.animation.getAnimationState(animationName).isPlaying) {\r\n            return;\r\n        }\r\n\r\n        this.animation.play(animationName);\r\n    }\r\n\r\n    stopAnimation(animationName: string) {\r\n        if (this.animation && this.animation.getAnimationState(animationName).isPlaying) {\r\n            this.animation.stop(animationName);\r\n        }\r\n    }\r\n\r\n    onKeyDown(event: cc.Event.EventKeyboard) {\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.up:\r\n                this.isMovingUp = true;\r\n                // this.playAnimation(\"man_up\");\r\n                //this.animation.play(\"man_up\");\r\n                break;\r\n            case cc.macro.KEY.down:\r\n                this.isMovingDown = true;\r\n                // this.playAnimation(\"man_down\");\r\n                //this.animation.play(\"man_down\");\r\n                break;\r\n            case cc.macro.KEY.left:\r\n                this.isMovingLeft = true;\r\n                // this.playAnimation(\"man_left\");\r\n                //this.animation.play(\"man_left\");\r\n                break;\r\n            case cc.macro.KEY.right:\r\n                this.isMovingRight = true;\r\n                // this.playAnimation(\"man_right\");\r\n                //this.animation.play(\"man_right\");\r\n                break;\r\n        }\r\n    }\r\n\r\n    onKeyUp(event: cc.Event.EventKeyboard) {\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.up:\r\n                this.isMovingUp = false;\r\n                 this.stopAnimation(\"man_up\");\r\n                break;\r\n            case cc.macro.KEY.down:\r\n                this.isMovingDown = false;\r\n                 this.stopAnimation(\"man_down\");\r\n                break;\r\n            case cc.macro.KEY.left:\r\n                this.isMovingLeft = false;\r\n                 this.stopAnimation(\"man_left\");\r\n                break;\r\n            case cc.macro.KEY.right:\r\n                this.isMovingRight = false;\r\n                 this.stopAnimation(\"man_right\");\r\n                break;\r\n        }\r\n    }\r\n\r\n    update(dt: number) {\r\n        cc.log(this.node.x, this.node.y);\r\n        // 根据按键状态更新角色位置\r\n        if(this.Gamemanger.palse==false)\r\n        {\r\n            if (this.isMovingUp) {\r\n            this.node.y += (this.moveSpeed * dt - 0.5 );\r\n                if(!this.animation.getAnimationState(\"man_up\").isPlaying)this.animation.play(\"man_up\");\r\n            }\r\n            if (this.isMovingDown) {\r\n                this.node.y -= this.moveSpeed * dt - 0.5;\r\n                if(!this.animation.getAnimationState(\"man_down\").isPlaying)this.animation.play(\"man_down\");\r\n            }\r\n            if (this.isMovingLeft) {\r\n                this.node.x -= this.moveSpeed * dt - + 0.5;\r\n                if(!this.animation.getAnimationState(\"man_left\").isPlaying)this.animation.play(\"man_left\");\r\n            }\r\n            if (this.isMovingRight) {\r\n                this.node.x += this.moveSpeed * dt - 0.5;\r\n                if(!this.animation.getAnimationState(\"man_right\").isPlaying)this.animation.play(\"man_right\");\r\n            }\r\n        }\r\n        \r\n        if ((this.node.x >= 48 && this.node.x <= 88) && (this.node.y >= 50 && this.node.y <= 86) && this.isBattle == false) {\r\n            // this.isBattle = true;\r\n            // cc.audioEngine.pauseMusic();\r\n            // cc.audioEngine.playEffect(this.goinSound, false);\r\n        \r\n            // var canvasNode = cc.find(\"Canvas\"); // 获取画布节点\r\n            // var blinkAction = cc.blink(2, 5); // 闪烁动画，持续时间为2秒，闪烁次数为5次\r\n            // this.Gamemanger.palse = true;\r\n            // console.log(this.Gamemanger.palse);\r\n            // canvasNode.runAction(cc.sequence(\r\n            //     blinkAction,\r\n            //     cc.callFunc(function () {\r\n            //         cc.director.loadScene(\"battle\");\r\n            //     })\r\n            // ));\r\n        }   \r\n    }\r\n\r\n    onBeginContact(contact, selfCollider, otherCollider) {\r\n        cc.log(\"Player hits the bush\");\r\n        let worldManifold = contact.getWorldManifold();\r\n        let points = worldManifold.points;\r\n        let normal = worldManifold.normal;\r\n        if(otherCollider.tag == 1){\r\n            cc.log(\"Player hits the enemy\");\r\n            this.isBattle = true;\r\n            cc.audioEngine.pauseMusic();\r\n            cc.audioEngine.playEffect(this.goinSound, false);\r\n        \r\n            var canvasNode = cc.find(\"Canvas\"); // 获取画布节点\r\n            var blinkAction = cc.blink(2, 5); // 闪烁动画，持续时间为2秒，闪烁次数为5次\r\n            this.Gamemanger.palse = true;\r\n            console.log(this.Gamemanger.palse);\r\n            canvasNode.runAction(cc.sequence(\r\n                blinkAction,\r\n                cc.callFunc(function () {\r\n                    cc.director.loadScene(\"battle\");\r\n                })\r\n            ));\r\n            //cc.audioEngine.pauseMusic();\r\n            //cc.audioEngine.playEffect(this.battleBgm, true);\r\n        }\r\n    }\r\n}"]}