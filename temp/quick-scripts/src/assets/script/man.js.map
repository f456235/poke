{"version":3,"sources":["assets\\script\\man.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\nimport GameManager from \"./gamemanager\";\r\nimport GlobalData from \"./GlobalData\";\r\n@ccclass\r\nexport default class Man extends cc.Component {\r\n\r\n    @property(GameManager)\r\n    Gamemanger: GameManager = null;\r\n\r\n    @property(cc.Label)\r\n    label: cc.Label = null;\r\n\r\n    @property\r\n    text: string = 'hello';\r\n\r\n    @property({type:cc.AudioClip})\r\n    bgmMapGrass: cc.AudioClip = null;\r\n\r\n    @property({type:cc.AudioClip})\r\n    bgmMapDesert: cc.AudioClip = null;\r\n    \r\n    @property({type:cc.AudioClip})\r\n    goinSound: cc.AudioClip = null;\r\n\r\n    @property(cc.Integer)\r\n    moveSpeed: number = 1; // 移动速度，可以根据需要调整\r\n\r\n    animation= null; // 动画组件\r\n\r\n    private isBattle: boolean = false;\r\n\r\n    private isMovingUp: boolean = false;\r\n    private isMovingDown: boolean = false;\r\n    private isMovingLeft: boolean = false;\r\n    private isMovingRight: boolean = false;\r\n    private destroynum = 0;\r\n    public enemyNum = 0;\r\n\r\n\r\n    start(){\r\n        GlobalData.isBOSScamera = false;\r\n        let nodetodestory = cc.director.getScene()[\"nodeToDestroy\"];\r\n        console.log(\"nodeToDestroy in man:\", nodetodestory);\r\n        //if(this.node.getChildByName(nodetodestory) !== null){\r\n        //    this.node.destroy();\r\n        //}\r\n        cc.director.getScene().walk((node: cc.Node) => {\r\n            // Perform operations on each node\r\n            // Access node properties, call methods, etc.\r\n            if(GlobalData.nodeToDestroy.includes(node.name)){\r\n                node.destroy();\r\n            }\r\n        }, () => {\r\n            // This callback is invoked after visiting each node in the scene hierarchy\r\n            //console.log(\"Iteration complete\");\r\n        });\r\n        let scene = cc.director.getScene();\r\n    if(scene.name == \"map2\"){\r\n        console.log(\"map2 bgm\");\r\n        cc.audioEngine.playMusic(this.bgmMapGrass, true);\r\n    }else if(scene.name == \"map3\"){\r\n        console.log(\"map3 bgm\");\r\n        cc.audioEngine.playMusic(this.bgmMapDesert, true);\r\n    }\r\n        this.Gamemanger = cc.find('Canvas/gamemanager').getComponent('gamemanager');\r\n        // console.log(this.Gamemanger);\r\n        this.Gamemanger.palse = false;\r\n    }\r\n\r\n    onLoad() {\r\n        // 注册键盘事件\r\n        cc.director.getPhysicsManager().enabled = true;\r\n        var manager = cc.director.getCollisionManager();\r\n        manager.enabled = true;\r\n        this.animation = this.getComponent(cc.Animation);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n        this.node.setPosition(GlobalData.PlayerPosX,GlobalData.PlayerPosY);\r\n        if(GlobalData.isEnenmyMagic && GlobalData.isEnenmyRed){\r\n            cc.find('enemies/6').active = true;\r\n        }\r\n        \r\n    }\r\n\r\n    onDestroy() {\r\n        // 移除键盘事件监听\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    playAnimation(animationName: string) {\r\n        if (this.animation && this.animation.getAnimationState(animationName).isPlaying) {\r\n            return;\r\n        }\r\n\r\n        this.animation.play(animationName);\r\n    }\r\n\r\n    stopAnimation(animationName: string) {\r\n        if (this.animation && this.animation.getAnimationState(animationName).isPlaying) {\r\n            this.animation.stop(animationName);\r\n        }\r\n    }\r\n\r\n    onKeyDown(event: cc.Event.EventKeyboard) {\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.up:\r\n                this.isMovingUp = true;\r\n                break;\r\n            case cc.macro.KEY.down:\r\n                this.isMovingDown = true;\r\n                break;\r\n            case cc.macro.KEY.left:\r\n                this.isMovingLeft = true;\r\n                break;\r\n            case cc.macro.KEY.right:\r\n                this.isMovingRight = true;\r\n                break;\r\n        }\r\n    }\r\n\r\n    onKeyUp(event: cc.Event.EventKeyboard) {\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.up:\r\n                this.isMovingUp = false;\r\n                 this.stopAnimation(\"man_up\");\r\n                break;\r\n            case cc.macro.KEY.down:\r\n                this.isMovingDown = false;\r\n                 this.stopAnimation(\"man_down\");\r\n                break;\r\n            case cc.macro.KEY.left:\r\n                this.isMovingLeft = false;\r\n                 this.stopAnimation(\"man_left\");\r\n                break;\r\n            case cc.macro.KEY.right:\r\n                this.isMovingRight = false;\r\n                 this.stopAnimation(\"man_right\");\r\n                break;\r\n        }\r\n    }\r\n\r\n    update(dt: number) {\r\n        \r\n        //console.log(GlobalData.isBOSScamera);\r\n        //cc.log(this.node.x, this.node.y);\r\n        // 根据按键状态更新角色位置\r\n        if(this.Gamemanger.palse==false)\r\n        {\r\n            if (this.isMovingUp) {\r\n            this.node.y += (this.moveSpeed * dt);\r\n                if(!this.animation.getAnimationState(\"man_up\").isPlaying)this.animation.play(\"man_up\");\r\n            }\r\n            if (this.isMovingDown) {\r\n                this.node.y -= this.moveSpeed * dt;\r\n                if(!this.animation.getAnimationState(\"man_down\").isPlaying)this.animation.play(\"man_down\");\r\n            }\r\n            if (this.isMovingLeft) {\r\n                this.node.x -= this.moveSpeed * dt;\r\n                if(!this.animation.getAnimationState(\"man_left\").isPlaying)this.animation.play(\"man_left\");\r\n            }\r\n            if (this.isMovingRight) {\r\n                this.node.x += this.moveSpeed * dt;\r\n                if(!this.animation.getAnimationState(\"man_right\").isPlaying)this.animation.play(\"man_right\");\r\n            }\r\n        }\r\n        \r\n        if ((this.node.x >= 48 && this.node.x <= 88) && (this.node.y >= 50 && this.node.y <= 86) && this.isBattle == false) {\r\n        }   \r\n        GlobalData.PlayerPosX = this.node.getPosition().x;\r\n        GlobalData.PlayerPosY = this.node.getPosition().y-10;  \r\n        cc.audioEngine.setMusicVolume(GlobalData.volume);\r\n        cc.audioEngine.setEffectsVolume(GlobalData.volume);\r\n    }\r\n\r\n    onBeginContact(contact, selfCollider, otherCollider) {\r\n        //cc.log(\"Player hits the bush\");\r\n        let worldManifold = contact.getWorldManifold();\r\n        let points = worldManifold.points;\r\n        let normal = worldManifold.normal;\r\n        if(otherCollider.tag == 4 || otherCollider.tag == 5 || otherCollider.tag == 6|| otherCollider.tag == 7 || otherCollider.tag == 8 ){\r\n            this.enemyNum = otherCollider.tag;\r\n            this.isBattle = true;\r\n            var canvasNode = cc.find(\"Canvas\");\r\n            const cameraNode = cc.Camera.main;\r\n            var blinkAction = cc.blink(2, 5);\r\n            this.Gamemanger.palse = true;\r\n            cc.audioEngine.pauseMusic();\r\n            if(otherCollider.tag != 8){\r\n                cc.audioEngine.playEffect(this.goinSound, false);\r\n                //console.log(this.Gamemanger.palse);\r\n                canvasNode.runAction(cc.sequence(\r\n                    blinkAction,\r\n                    cc.callFunc(function () {\r\n                        \r\n                        cc.director.loadScene(\"battle\", () =>{\r\n                        const nextScene = cc.director.getScene();\r\n                        nextScene[\"enemyNum\"] = otherCollider.tag;\r\n                        //console.log(\"nextScene[enemyNum]\", nextScene[\"enemyNum\"]);\r\n                        });\r\n                    })\r\n                ));\r\n            }else if(otherCollider.tag == 8){\r\n                GlobalData.isBOSScamera = true;\r\n                //let cameraAction = cameraNode.runAction(cc.moveTo(2, cc.v2(0,50)));\r\n                let cameraAction = cc.callFunc(function(target) {\r\n                    const mainCamera = cc.Camera.main;\r\n                    this.originalPosition = mainCamera.node.position.clone();\r\n                   //let shakeSequence;\r\n                   console.log(\"shakeSequence\");\r\n                    \r\n                    const shakeSequence = cc.moveTo(3, cc.v2(this.originalPosition.x , this.originalPosition.y+70));\r\n                    \r\n                    cc.find(\"Canvas/Main Camera\").getComponent(cc.Camera).node.runAction(shakeSequence);\r\n                });\r\n                \r\n\r\n                let loadAction = cc.moveBy(4, cc.v2(0,0));\r\n                this.scheduleOnce(function() {\r\n                    GlobalData.isBOSScamera = false;\r\n                }, 13);\r\n\r\n                let conversationAction = cc.callFunc(function(target) {\r\n                    cc.find(\"Canvas/Main Camera/moyan\").active = true;\r\n                });\r\n\r\n                this.scheduleOnce(function() {\r\n                    cc.audioEngine.playEffect(this.goinSound, false);\r\n                }, 8);\r\n\r\n                this.scheduleOnce(function() {\r\n                    cc.find(\"Canvas/Main Camera/moyan\").active = false;\r\n                }, 8);\r\n                \r\n                canvasNode.runAction(cc.sequence(\r\n                    cameraAction,\r\n                    loadAction,\r\n                    conversationAction,\r\n                    loadAction,\r\n                    blinkAction,\r\n                    cc.callFunc(function () {\r\n                        \r\n                        cc.director.loadScene(\"battle\", () =>{\r\n                        const nextScene = cc.director.getScene();\r\n                        nextScene[\"enemyNum\"] = otherCollider.tag;\r\n                        //console.log(\"nextScene[enemyNum]\", nextScene[\"enemyNum\"]);\r\n                        });\r\n                    })\r\n                ));\r\n                \r\n            }\r\n            //cc.audioEngine.pauseMusic();\r\n            //cc.audioEngine.playEffect(this.battleBgm, true);\r\n        }\r\n    }\r\n}"]}